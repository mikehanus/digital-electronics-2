<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Watering system with Arudino UNO without Arduino libraries: TWI Library &lt;twi.h&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Watering system with Arudino UNO without Arduino libraries<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Program řeší automatické zalévání květin. Pomocí kapacitního senzoru je měřena vlhkost půdy. Pomocí teploměru a vlhkoměru DHT12 je měřena teplota a vlhkost vzduchu. Pomocí serva je otáčena trubička s vodu, která po otočení začne zalévat květinu. Servo povolí zalévání pokud vlhkost půdy klesne pod určitou hodnotu a skončí zalévání pokud se hodnota vlhkosti půdy dostane nad určitou hodnotu. Tyto hodnoty lze definovat pomocí příkazové řádky. Pomocí příkazové řádky lze vypsat teplota a vlhkost ovzduší, vlhkost půdy a čas. Také lze pomocí příkazu vyvolat pomocné menu, ve kterém jsou napsány všechny příkazy. Každou minutu ukládá program data ze senzorů do paměti EEPROM. Tyto hodnoty lze uložit do CSV souboru a nebo zobrazit v příkazové řádce.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">TWI Library &lt;twi.h&gt;</div></div>
</div><!--header-->
<div class="contents">

<p>I2C/TWI library for AVR-GCC.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Other definitions</h2></td></tr>
<tr class="memitem:ga16f0e6b2fa5a26eadbf4086ab6d54467"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga16f0e6b2fa5a26eadbf4086ab6d54467">twi_init</a> (void)</td></tr>
<tr class="memdesc:ga16f0e6b2fa5a26eadbf4086ab6d54467"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize TWI unit, enable internal pull-ups, and set SCL frequency.  <a href="group__fryza__twi.html#ga16f0e6b2fa5a26eadbf4086ab6d54467">More...</a><br /></td></tr>
<tr class="separator:ga16f0e6b2fa5a26eadbf4086ab6d54467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf37269da7f6b1b22438b78d2f965f274"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#gaf37269da7f6b1b22438b78d2f965f274">twi_start</a> (void)</td></tr>
<tr class="memdesc:gaf37269da7f6b1b22438b78d2f965f274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start communication on I2C/TWI bus.  <a href="group__fryza__twi.html#gaf37269da7f6b1b22438b78d2f965f274">More...</a><br /></td></tr>
<tr class="separator:gaf37269da7f6b1b22438b78d2f965f274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga129b8a79f75189c3801cb7082e6b8340"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga129b8a79f75189c3801cb7082e6b8340">twi_write</a> (uint8_t <a class="el" href="uart_8c.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>)</td></tr>
<tr class="memdesc:ga129b8a79f75189c3801cb7082e6b8340"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send one byte to I2C/TWI Slave device.  <a href="group__fryza__twi.html#ga129b8a79f75189c3801cb7082e6b8340">More...</a><br /></td></tr>
<tr class="separator:ga129b8a79f75189c3801cb7082e6b8340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9f84b771b4acdedd2106e91cb03cc78"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#gae9f84b771b4acdedd2106e91cb03cc78">twi_read</a> (uint8_t ack)</td></tr>
<tr class="memdesc:gae9f84b771b4acdedd2106e91cb03cc78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one byte from I2C/TWI Slave device and acknowledge it by ACK or NACK.  <a href="group__fryza__twi.html#gae9f84b771b4acdedd2106e91cb03cc78">More...</a><br /></td></tr>
<tr class="separator:gae9f84b771b4acdedd2106e91cb03cc78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacf52d6c93df110dee6d402b389e5042e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#gacf52d6c93df110dee6d402b389e5042e">twi_stop</a> (void)</td></tr>
<tr class="memdesc:gacf52d6c93df110dee6d402b389e5042e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates Stop condition on I2C/TWI bus.  <a href="group__fryza__twi.html#gacf52d6c93df110dee6d402b389e5042e">More...</a><br /></td></tr>
<tr class="separator:gacf52d6c93df110dee6d402b389e5042e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f677656a04639fb33a080f0fa7a1011"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011">twi_test_address</a> (uint8_t adr)</td></tr>
<tr class="memdesc:ga4f677656a04639fb33a080f0fa7a1011"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test presence of one I2C device on the bus.  <a href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011">More...</a><br /></td></tr>
<tr class="separator:ga4f677656a04639fb33a080f0fa7a1011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b68e8e777b71520f9dbfac733774d5f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga3b68e8e777b71520f9dbfac733774d5f">TWI_WRITE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga3b68e8e777b71520f9dbfac733774d5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mode for writing to I2C/TWI device.  <a href="group__fryza__twi.html#ga3b68e8e777b71520f9dbfac733774d5f">More...</a><br /></td></tr>
<tr class="separator:ga3b68e8e777b71520f9dbfac733774d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf9a8abccd811954f9cc316f2b2f87b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#gaaf9a8abccd811954f9cc316f2b2f87b3">TWI_READ</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gaaf9a8abccd811954f9cc316f2b2f87b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mode for reading from I2C/TWI device.  <a href="group__fryza__twi.html#gaaf9a8abccd811954f9cc316f2b2f87b3">More...</a><br /></td></tr>
<tr class="separator:gaaf9a8abccd811954f9cc316f2b2f87b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00dcb08e2effea903c22763e0aeeb3cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga00dcb08e2effea903c22763e0aeeb3cb">TWI_ACK</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga00dcb08e2effea903c22763e0aeeb3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">ACK value for writing to I2C/TWI bus.  <a href="group__fryza__twi.html#ga00dcb08e2effea903c22763e0aeeb3cb">More...</a><br /></td></tr>
<tr class="separator:ga00dcb08e2effea903c22763e0aeeb3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf28e960d6d1c0553791faf52ebd8ef6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#gaaf28e960d6d1c0553791faf52ebd8ef6">TWI_NACK</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gaaf28e960d6d1c0553791faf52ebd8ef6"><td class="mdescLeft">&#160;</td><td class="mdescRight">NACK value for writing to I2C/TWI bus.  <a href="group__fryza__twi.html#gaaf28e960d6d1c0553791faf52ebd8ef6">More...</a><br /></td></tr>
<tr class="separator:gaaf28e960d6d1c0553791faf52ebd8ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c0346728feb274834cad94daca316ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga6c0346728feb274834cad94daca316ee">DDR</a>(_x)&#160;&#160;&#160;(*(&amp;_x - 1))</td></tr>
<tr class="memdesc:ga6c0346728feb274834cad94daca316ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Address of Data Direction Register of port _x.  <a href="group__fryza__twi.html#ga6c0346728feb274834cad94daca316ee">More...</a><br /></td></tr>
<tr class="separator:ga6c0346728feb274834cad94daca316ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga740f9eb9c9f9e33500ee61ec53945f6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga740f9eb9c9f9e33500ee61ec53945f6a">PIN</a>(_x)&#160;&#160;&#160;(*(&amp;_x - 2))</td></tr>
<tr class="memdesc:ga740f9eb9c9f9e33500ee61ec53945f6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Address of input register of port _x.  <a href="group__fryza__twi.html#ga740f9eb9c9f9e33500ee61ec53945f6a">More...</a><br /></td></tr>
<tr class="separator:ga740f9eb9c9f9e33500ee61ec53945f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Definition of frequencies</h2></td></tr>
<tr class="memitem:ga43bafb28b29491ec7f871319b5a3b2f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a>&#160;&#160;&#160;16000000</td></tr>
<tr class="memdesc:ga43bafb28b29491ec7f871319b5a3b2f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">CPU frequency in Hz required TWI_BIT_RATE_REG.  <a href="group__fryza__twi.html#ga43bafb28b29491ec7f871319b5a3b2f8">More...</a><br /></td></tr>
<tr class="separator:ga43bafb28b29491ec7f871319b5a3b2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a1c522bed64982971384489ee477bd3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga7a1c522bed64982971384489ee477bd3">F_SCL</a>&#160;&#160;&#160;100000</td></tr>
<tr class="memdesc:ga7a1c522bed64982971384489ee477bd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">I2C/TWI bit rate. Must be greater than 31000.  <a href="group__fryza__twi.html#ga7a1c522bed64982971384489ee477bd3">More...</a><br /></td></tr>
<tr class="separator:ga7a1c522bed64982971384489ee477bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga801c158406ca2334b446e442a2debe37"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga801c158406ca2334b446e442a2debe37">TWI_BIT_RATE_REG</a>&#160;&#160;&#160;((<a class="el" href="main_8c.html#a43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a>/<a class="el" href="group__fryza__twi.html#ga7a1c522bed64982971384489ee477bd3">F_SCL</a> - 16) / 2)</td></tr>
<tr class="memdesc:ga801c158406ca2334b446e442a2debe37"><td class="mdescLeft">&#160;</td><td class="mdescRight">TWI bit rate register value.  <a href="group__fryza__twi.html#ga801c158406ca2334b446e442a2debe37">More...</a><br /></td></tr>
<tr class="separator:ga801c158406ca2334b446e442a2debe37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Definition of ports and pins</h2></td></tr>
<tr class="memitem:ga762c164f4acd04d3ce3627fe73e7c018"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga762c164f4acd04d3ce3627fe73e7c018">TWI_PORT</a>&#160;&#160;&#160;PORTC</td></tr>
<tr class="memdesc:ga762c164f4acd04d3ce3627fe73e7c018"><td class="mdescLeft">&#160;</td><td class="mdescRight">Port of TWI unit.  <a href="group__fryza__twi.html#ga762c164f4acd04d3ce3627fe73e7c018">More...</a><br /></td></tr>
<tr class="separator:ga762c164f4acd04d3ce3627fe73e7c018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f14ed8491293d0dda1372cceaa39851"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#ga3f14ed8491293d0dda1372cceaa39851">TWI_SDA_PIN</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:ga3f14ed8491293d0dda1372cceaa39851"><td class="mdescLeft">&#160;</td><td class="mdescRight">SDA pin of TWI unit.  <a href="group__fryza__twi.html#ga3f14ed8491293d0dda1372cceaa39851">More...</a><br /></td></tr>
<tr class="separator:ga3f14ed8491293d0dda1372cceaa39851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0ad8b33f1be48e211f1eeae2dd65cee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fryza__twi.html#gac0ad8b33f1be48e211f1eeae2dd65cee">TWI_SCL_PIN</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:gac0ad8b33f1be48e211f1eeae2dd65cee"><td class="mdescLeft">&#160;</td><td class="mdescRight">SCL pin of TWI unit.  <a href="group__fryza__twi.html#gac0ad8b33f1be48e211f1eeae2dd65cee">More...</a><br /></td></tr>
<tr class="separator:gac0ad8b33f1be48e211f1eeae2dd65cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >I2C/TWI library for AVR-GCC. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="twi_8h.html">twi.h</a>&gt;</span> </div>
<div class="ttc" id="atwi_8h_html"><div class="ttname"><a href="twi_8h.html">twi.h</a></div></div>
</div><!-- fragment --><p >This library defines functions for the TWI (I2C) communication between AVR and Slave device(s). Functions use internal TWI module of AVR.</p>
<dl class="section note"><dt>Note</dt><dd>Only Master transmitting and Master receiving modes are implemented. Based on Microchip Atmel ATmega16 and ATmega328P manuals. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Tomas Fryza, Dept. of Radio Electronics, Brno University of Technology, Czechia </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) 2018 Tomas Fryza, This work is licensed under the terms of the MIT license </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga6c0346728feb274834cad94daca316ee" name="ga6c0346728feb274834cad94daca316ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6c0346728feb274834cad94daca316ee">&#9670;&nbsp;</a></span>DDR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_x</td><td>)</td>
          <td>&#160;&#160;&#160;(*(&amp;_x - 1))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Address of Data Direction Register of port _x. </p>

</div>
</div>
<a id="ga43bafb28b29491ec7f871319b5a3b2f8" name="ga43bafb28b29491ec7f871319b5a3b2f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga43bafb28b29491ec7f871319b5a3b2f8">&#9670;&nbsp;</a></span>F_CPU</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define F_CPU&#160;&#160;&#160;16000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CPU frequency in Hz required TWI_BIT_RATE_REG. </p>

</div>
</div>
<a id="ga7a1c522bed64982971384489ee477bd3" name="ga7a1c522bed64982971384489ee477bd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a1c522bed64982971384489ee477bd3">&#9670;&nbsp;</a></span>F_SCL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define F_SCL&#160;&#160;&#160;100000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>I2C/TWI bit rate. Must be greater than 31000. </p>

</div>
</div>
<a id="ga740f9eb9c9f9e33500ee61ec53945f6a" name="ga740f9eb9c9f9e33500ee61ec53945f6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga740f9eb9c9f9e33500ee61ec53945f6a">&#9670;&nbsp;</a></span>PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_x</td><td>)</td>
          <td>&#160;&#160;&#160;(*(&amp;_x - 2))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Address of input register of port _x. </p>

</div>
</div>
<a id="ga00dcb08e2effea903c22763e0aeeb3cb" name="ga00dcb08e2effea903c22763e0aeeb3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga00dcb08e2effea903c22763e0aeeb3cb">&#9670;&nbsp;</a></span>TWI_ACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_ACK&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ACK value for writing to I2C/TWI bus. </p>

</div>
</div>
<a id="ga801c158406ca2334b446e442a2debe37" name="ga801c158406ca2334b446e442a2debe37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga801c158406ca2334b446e442a2debe37">&#9670;&nbsp;</a></span>TWI_BIT_RATE_REG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_BIT_RATE_REG&#160;&#160;&#160;((<a class="el" href="main_8c.html#a43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a>/<a class="el" href="group__fryza__twi.html#ga7a1c522bed64982971384489ee477bd3">F_SCL</a> - 16) / 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TWI bit rate register value. </p>

</div>
</div>
<a id="gaaf28e960d6d1c0553791faf52ebd8ef6" name="gaaf28e960d6d1c0553791faf52ebd8ef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf28e960d6d1c0553791faf52ebd8ef6">&#9670;&nbsp;</a></span>TWI_NACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_NACK&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>NACK value for writing to I2C/TWI bus. </p>

</div>
</div>
<a id="ga762c164f4acd04d3ce3627fe73e7c018" name="ga762c164f4acd04d3ce3627fe73e7c018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga762c164f4acd04d3ce3627fe73e7c018">&#9670;&nbsp;</a></span>TWI_PORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_PORT&#160;&#160;&#160;PORTC</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Port of TWI unit. </p>

</div>
</div>
<a id="gaaf9a8abccd811954f9cc316f2b2f87b3" name="gaaf9a8abccd811954f9cc316f2b2f87b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf9a8abccd811954f9cc316f2b2f87b3">&#9670;&nbsp;</a></span>TWI_READ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_READ&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mode for reading from I2C/TWI device. </p>

</div>
</div>
<a id="gac0ad8b33f1be48e211f1eeae2dd65cee" name="gac0ad8b33f1be48e211f1eeae2dd65cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac0ad8b33f1be48e211f1eeae2dd65cee">&#9670;&nbsp;</a></span>TWI_SCL_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_SCL_PIN&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SCL pin of TWI unit. </p>

</div>
</div>
<a id="ga3f14ed8491293d0dda1372cceaa39851" name="ga3f14ed8491293d0dda1372cceaa39851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3f14ed8491293d0dda1372cceaa39851">&#9670;&nbsp;</a></span>TWI_SDA_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_SDA_PIN&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SDA pin of TWI unit. </p>

</div>
</div>
<a id="ga3b68e8e777b71520f9dbfac733774d5f" name="ga3b68e8e777b71520f9dbfac733774d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3b68e8e777b71520f9dbfac733774d5f">&#9670;&nbsp;</a></span>TWI_WRITE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_WRITE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mode for writing to I2C/TWI device. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga16f0e6b2fa5a26eadbf4086ab6d54467" name="ga16f0e6b2fa5a26eadbf4086ab6d54467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga16f0e6b2fa5a26eadbf4086ab6d54467">&#9670;&nbsp;</a></span>twi_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twi_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize TWI unit, enable internal pull-ups, and set SCL frequency. </p>
<dl class="section user"><dt>Implementation notes:</dt><dd><ul>
<li>AVR internal pull-up resistors at pins TWI_SDA_PIN and TWI_SCL_PIN are enabled</li>
<li>TWI bit rate register value is calculated as follows fscl = fcpu/(16 + 2*TWBR) </li>
</ul>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   29</span>{</div>
<div class="line"><span class="lineno">   30</span>    <span class="comment">/* Enable internal pull-up resistors */</span></div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_define" href="group__fryza__twi.html#ga6c0346728feb274834cad94daca316ee">DDR</a>(<a class="code hl_define" href="group__fryza__twi.html#ga762c164f4acd04d3ce3627fe73e7c018">TWI_PORT</a>) &amp;= ~((1&lt;&lt;<a class="code hl_define" href="group__fryza__twi.html#ga3f14ed8491293d0dda1372cceaa39851">TWI_SDA_PIN</a>) | (1&lt;&lt;<a class="code hl_define" href="group__fryza__twi.html#gac0ad8b33f1be48e211f1eeae2dd65cee">TWI_SCL_PIN</a>));</div>
<div class="line"><span class="lineno">   32</span>    <a class="code hl_define" href="group__fryza__twi.html#ga762c164f4acd04d3ce3627fe73e7c018">TWI_PORT</a> |= (1&lt;&lt;<a class="code hl_define" href="group__fryza__twi.html#ga3f14ed8491293d0dda1372cceaa39851">TWI_SDA_PIN</a>) | (1&lt;&lt;<a class="code hl_define" href="group__fryza__twi.html#gac0ad8b33f1be48e211f1eeae2dd65cee">TWI_SCL_PIN</a>);</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>    <span class="comment">/* Set SCL frequency */</span></div>
<div class="line"><span class="lineno">   35</span>    TWSR &amp;= ~((1&lt;&lt;TWPS1) | (1&lt;&lt;TWPS0));</div>
<div class="line"><span class="lineno">   36</span>    TWBR = <a class="code hl_define" href="group__fryza__twi.html#ga801c158406ca2334b446e442a2debe37">TWI_BIT_RATE_REG</a>;</div>
<div class="line"><span class="lineno">   37</span>}</div>
<div class="ttc" id="agroup__fryza__twi_html_ga3f14ed8491293d0dda1372cceaa39851"><div class="ttname"><a href="group__fryza__twi.html#ga3f14ed8491293d0dda1372cceaa39851">TWI_SDA_PIN</a></div><div class="ttdeci">#define TWI_SDA_PIN</div><div class="ttdoc">SDA pin of TWI unit.</div><div class="ttdef"><b>Definition:</b> twi.h:54</div></div>
<div class="ttc" id="agroup__fryza__twi_html_ga6c0346728feb274834cad94daca316ee"><div class="ttname"><a href="group__fryza__twi.html#ga6c0346728feb274834cad94daca316ee">DDR</a></div><div class="ttdeci">#define DDR(_x)</div><div class="ttdoc">Address of Data Direction Register of port _x.</div><div class="ttdef"><b>Definition:</b> twi.h:65</div></div>
<div class="ttc" id="agroup__fryza__twi_html_ga762c164f4acd04d3ce3627fe73e7c018"><div class="ttname"><a href="group__fryza__twi.html#ga762c164f4acd04d3ce3627fe73e7c018">TWI_PORT</a></div><div class="ttdeci">#define TWI_PORT</div><div class="ttdoc">Port of TWI unit.</div><div class="ttdef"><b>Definition:</b> twi.h:53</div></div>
<div class="ttc" id="agroup__fryza__twi_html_ga801c158406ca2334b446e442a2debe37"><div class="ttname"><a href="group__fryza__twi.html#ga801c158406ca2334b446e442a2debe37">TWI_BIT_RATE_REG</a></div><div class="ttdeci">#define TWI_BIT_RATE_REG</div><div class="ttdoc">TWI bit rate register value.</div><div class="ttdef"><b>Definition:</b> twi.h:47</div></div>
<div class="ttc" id="agroup__fryza__twi_html_gac0ad8b33f1be48e211f1eeae2dd65cee"><div class="ttname"><a href="group__fryza__twi.html#gac0ad8b33f1be48e211f1eeae2dd65cee">TWI_SCL_PIN</a></div><div class="ttdeci">#define TWI_SCL_PIN</div><div class="ttdoc">SCL pin of TWI unit.</div><div class="ttdef"><b>Definition:</b> twi.h:55</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="oled_8c.html#adf4cfb5ed444b0ab8cd162456c017934">oled_init()</a>, and <a class="el" href="sensors_8c.html#a41e7d1dd0cac7bd20fc32a6ebc87a985">sensors_init()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fryza__twi_ga16f0e6b2fa5a26eadbf4086ab6d54467_icgraph.png" border="0" usemap="#agroup__fryza__twi_ga16f0e6b2fa5a26eadbf4086ab6d54467_icgraph" alt=""/></div>
<map name="agroup__fryza__twi_ga16f0e6b2fa5a26eadbf4086ab6d54467_icgraph" id="agroup__fryza__twi_ga16f0e6b2fa5a26eadbf4086ab6d54467_icgraph">
<area shape="rect" title="Initialize TWI unit, enable internal pull&#45;ups, and set SCL frequency." alt="" coords="299,31,369,57"/>
<area shape="rect" href="oled_8c.html#adf4cfb5ed444b0ab8cd162456c017934" title=" " alt="" coords="161,5,240,32"/>
<area shape="rect" href="sensors_8c.html#a41e7d1dd0cac7bd20fc32a6ebc87a985" title=" " alt="" coords="151,56,251,83"/>
<area shape="rect" href="display_8c.html#a8d41c12af4f6e6faad84e1f21f99b3e1" title=" " alt="" coords="5,5,103,32"/>
</map>
</div>

</div>
</div>
<a id="gae9f84b771b4acdedd2106e91cb03cc78" name="gae9f84b771b4acdedd2106e91cb03cc78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae9f84b771b4acdedd2106e91cb03cc78">&#9670;&nbsp;</a></span>twi_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t twi_read </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ack</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read one byte from I2C/TWI Slave device and acknowledge it by ACK or NACK. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ack</td><td>- ACK/NACK value to be transmitted </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Received data byte </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   91</span>{</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">if</span> (ack == <a class="code hl_define" href="group__fryza__twi.html#ga00dcb08e2effea903c22763e0aeeb3cb">TWI_ACK</a>)</div>
<div class="line"><span class="lineno">   93</span>        TWCR = (1&lt;&lt;TWINT) | (1&lt;&lt;TWEN) | (1&lt;&lt;TWEA);</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   95</span>        TWCR = (1&lt;&lt;TWINT) | (1&lt;&lt;TWEN);</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">for</span>(uint32_t i = 0; i &lt; <a class="code hl_define" href="twi_8c.html#aae1d7716ad5fb6be8b904e8a0def77c5">TWI_TIMEOUT</a> &amp;&amp; ((TWCR &amp; (1&lt;&lt;TWINT)) == 0); i++) <span class="keyword">asm</span>(<span class="stringliteral">&quot;NOP&quot;</span>);</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">return</span> (TWDR);</div>
<div class="line"><span class="lineno">   99</span>}</div>
<div class="ttc" id="agroup__fryza__twi_html_ga00dcb08e2effea903c22763e0aeeb3cb"><div class="ttname"><a href="group__fryza__twi.html#ga00dcb08e2effea903c22763e0aeeb3cb">TWI_ACK</a></div><div class="ttdeci">#define TWI_ACK</div><div class="ttdoc">ACK value for writing to I2C/TWI bus.</div><div class="ttdef"><b>Definition:</b> twi.h:63</div></div>
<div class="ttc" id="atwi_8c_html_aae1d7716ad5fb6be8b904e8a0def77c5"><div class="ttname"><a href="twi_8c.html#aae1d7716ad5fb6be8b904e8a0def77c5">TWI_TIMEOUT</a></div><div class="ttdeci">#define TWI_TIMEOUT</div><div class="ttdef"><b>Definition:</b> twi.c:18</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693">sensors_update_dataset()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fryza__twi_gae9f84b771b4acdedd2106e91cb03cc78_icgraph.png" border="0" usemap="#agroup__fryza__twi_gae9f84b771b4acdedd2106e91cb03cc78_icgraph" alt=""/></div>
<map name="agroup__fryza__twi_gae9f84b771b4acdedd2106e91cb03cc78_icgraph" id="agroup__fryza__twi_gae9f84b771b4acdedd2106e91cb03cc78_icgraph">
<area shape="rect" title="Read one byte from I2C/TWI Slave device and acknowledge it by ACK or NACK." alt="" coords="233,5,312,32"/>
<area shape="rect" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693" title=" " alt="" coords="5,5,185,32"/>
</map>
</div>

</div>
</div>
<a id="gaf37269da7f6b1b22438b78d2f965f274" name="gaf37269da7f6b1b22438b78d2f965f274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf37269da7f6b1b22438b78d2f965f274">&#9670;&nbsp;</a></span>twi_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twi_start </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start communication on I2C/TWI bus. </p>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   46</span>{</div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">/* Send Start condition */</span></div>
<div class="line"><span class="lineno">   48</span>    TWCR = (1&lt;&lt;TWINT) | (1&lt;&lt;TWSTA) | (1&lt;&lt;TWEN);</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">for</span>(uint32_t i = 0; i &lt; <a class="code hl_define" href="twi_8c.html#aae1d7716ad5fb6be8b904e8a0def77c5">TWI_TIMEOUT</a> &amp;&amp; ((TWCR &amp; (1&lt;&lt;TWINT)) == 0); i++) <span class="keyword">asm</span>(<span class="stringliteral">&quot;NOP&quot;</span>);</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="oled_8c.html#a91b0721118752b7208388903b69332e4">oled_command()</a>, <a class="el" href="oled_8c.html#a93bdfec1e1e604f1666485179d769f01">oled_data()</a>, <a class="el" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693">sensors_update_dataset()</a>, and <a class="el" href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011">twi_test_address()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fryza__twi_gaf37269da7f6b1b22438b78d2f965f274_icgraph.png" border="0" usemap="#agroup__fryza__twi_gaf37269da7f6b1b22438b78d2f965f274_icgraph" alt=""/></div>
<map name="agroup__fryza__twi_gaf37269da7f6b1b22438b78d2f965f274_icgraph" id="agroup__fryza__twi_gaf37269da7f6b1b22438b78d2f965f274_icgraph">
<area shape="rect" title="Start communication on I2C/TWI bus." alt="" coords="1256,352,1335,379"/>
<area shape="rect" href="oled_8c.html#a91b0721118752b7208388903b69332e4" title=" " alt="" coords="1057,327,1179,353"/>
<area shape="rect" href="oled_8c.html#a93bdfec1e1e604f1666485179d769f01" title=" " alt="" coords="700,131,787,157"/>
<area shape="rect" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693" title=" " alt="" coords="1028,377,1208,404"/>
<area shape="rect" href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011" title="Test presence of one I2C device on the bus." alt="" coords="1052,428,1184,455"/>
<area shape="rect" href="oled_8c.html#afef0e0a3d794e2cd2132e24b65fc55c0" title=" " alt="" coords="873,403,950,429"/>
<area shape="rect" href="oled_8c.html#a869429d91a0e3b943fa70344cea07f52" title=" " alt="" coords="843,251,979,277"/>
<area shape="rect" href="oled_8c.html#adf4cfb5ed444b0ab8cd162456c017934" title=" " alt="" coords="185,435,263,461"/>
<area shape="rect" href="oled_8c.html#acbecdceb919c4ca42478f8f8631a588b" title=" " alt="" coords="528,29,613,56"/>
<area shape="rect" href="oled_8c.html#a55064af8d04c97be4ec4751b1e7566eb" title=" " alt="" coords="864,536,959,563"/>
<area shape="rect" href="oled_8c.html#a551373c9f50c6edcbf0aff140c98535a" title=" " alt="" coords="843,301,980,328"/>
<area shape="rect" href="oled_8c.html#a0e010462121972ef0669b30f68d68b7b" title=" " alt="" coords="865,352,957,379"/>
<area shape="rect" href="oled_8c.html#ad9a1e40ca811bb4c2f095b31e3c3def1" title=" " alt="" coords="497,181,644,208"/>
<area shape="rect" href="oled_8c.html#a89aa3a9a7daa84a50f00399d32d9dfa2" title=" " alt="" coords="692,283,795,309"/>
<area shape="rect" href="display_8c.html#a8d41c12af4f6e6faad84e1f21f99b3e1" title=" " alt="" coords="5,333,103,360"/>
<area shape="rect" href="display_8c.html#af6002a9b15fd411e61bc74a7ace0d457" title=" " alt="" coords="151,283,297,309"/>
<area shape="rect" href="oled_8c.html#a87e32cd0efcfb14bfa3c71e386498df6" title=" " alt="" coords="351,384,443,411"/>
<area shape="rect" href="oled_8c.html#aebb4380fed7380f42c7c465430de9012" title=" " alt="" coords="345,232,449,259"/>
<area shape="rect" href="oled_8c.html#ac3d3bd3760c4da609cc310cba9887a55" title=" " alt="" coords="523,435,618,461"/>
<area shape="rect" href="oled_8c.html#a8daec8fb691af3b411501856f9291683" title=" " alt="" coords="355,181,440,208"/>
<area shape="rect" href="oled_8c.html#a6c489aec7c018385dc95b01400ef1f14" title=" " alt="" coords="347,29,447,56"/>
</map>
</div>

</div>
</div>
<a id="gacf52d6c93df110dee6d402b389e5042e" name="gacf52d6c93df110dee6d402b389e5042e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacf52d6c93df110dee6d402b389e5042e">&#9670;&nbsp;</a></span>twi_stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twi_stop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates Stop condition on I2C/TWI bus. </p>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  108</span>{</div>
<div class="line"><span class="lineno">  109</span>    <span class="comment">/* Generate Stop condition on I2C/TWI bus */</span></div>
<div class="line"><span class="lineno">  110</span>    TWCR = (1&lt;&lt;TWINT) | (1&lt;&lt;TWSTO) | (1&lt;&lt;TWEN);</div>
<div class="line"><span class="lineno">  111</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="oled_8c.html#a91b0721118752b7208388903b69332e4">oled_command()</a>, <a class="el" href="oled_8c.html#a93bdfec1e1e604f1666485179d769f01">oled_data()</a>, <a class="el" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693">sensors_update_dataset()</a>, and <a class="el" href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011">twi_test_address()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fryza__twi_gacf52d6c93df110dee6d402b389e5042e_icgraph.png" border="0" usemap="#agroup__fryza__twi_gacf52d6c93df110dee6d402b389e5042e_icgraph" alt=""/></div>
<map name="agroup__fryza__twi_gacf52d6c93df110dee6d402b389e5042e_icgraph" id="agroup__fryza__twi_gacf52d6c93df110dee6d402b389e5042e_icgraph">
<area shape="rect" title="Generates Stop condition on I2C/TWI bus." alt="" coords="1256,352,1333,379"/>
<area shape="rect" href="oled_8c.html#a91b0721118752b7208388903b69332e4" title=" " alt="" coords="1057,327,1179,353"/>
<area shape="rect" href="oled_8c.html#a93bdfec1e1e604f1666485179d769f01" title=" " alt="" coords="700,131,787,157"/>
<area shape="rect" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693" title=" " alt="" coords="1028,377,1208,404"/>
<area shape="rect" href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011" title="Test presence of one I2C device on the bus." alt="" coords="1052,428,1184,455"/>
<area shape="rect" href="oled_8c.html#afef0e0a3d794e2cd2132e24b65fc55c0" title=" " alt="" coords="873,403,950,429"/>
<area shape="rect" href="oled_8c.html#a869429d91a0e3b943fa70344cea07f52" title=" " alt="" coords="843,251,979,277"/>
<area shape="rect" href="oled_8c.html#adf4cfb5ed444b0ab8cd162456c017934" title=" " alt="" coords="185,435,263,461"/>
<area shape="rect" href="oled_8c.html#acbecdceb919c4ca42478f8f8631a588b" title=" " alt="" coords="528,29,613,56"/>
<area shape="rect" href="oled_8c.html#a55064af8d04c97be4ec4751b1e7566eb" title=" " alt="" coords="864,536,959,563"/>
<area shape="rect" href="oled_8c.html#a551373c9f50c6edcbf0aff140c98535a" title=" " alt="" coords="843,301,980,328"/>
<area shape="rect" href="oled_8c.html#a0e010462121972ef0669b30f68d68b7b" title=" " alt="" coords="865,352,957,379"/>
<area shape="rect" href="oled_8c.html#ad9a1e40ca811bb4c2f095b31e3c3def1" title=" " alt="" coords="497,181,644,208"/>
<area shape="rect" href="oled_8c.html#a89aa3a9a7daa84a50f00399d32d9dfa2" title=" " alt="" coords="692,283,795,309"/>
<area shape="rect" href="display_8c.html#a8d41c12af4f6e6faad84e1f21f99b3e1" title=" " alt="" coords="5,333,103,360"/>
<area shape="rect" href="display_8c.html#af6002a9b15fd411e61bc74a7ace0d457" title=" " alt="" coords="151,283,297,309"/>
<area shape="rect" href="oled_8c.html#a87e32cd0efcfb14bfa3c71e386498df6" title=" " alt="" coords="351,384,443,411"/>
<area shape="rect" href="oled_8c.html#aebb4380fed7380f42c7c465430de9012" title=" " alt="" coords="345,232,449,259"/>
<area shape="rect" href="oled_8c.html#ac3d3bd3760c4da609cc310cba9887a55" title=" " alt="" coords="523,435,618,461"/>
<area shape="rect" href="oled_8c.html#a8daec8fb691af3b411501856f9291683" title=" " alt="" coords="355,181,440,208"/>
<area shape="rect" href="oled_8c.html#a6c489aec7c018385dc95b01400ef1f14" title=" " alt="" coords="347,29,447,56"/>
</map>
</div>

</div>
</div>
<a id="ga4f677656a04639fb33a080f0fa7a1011" name="ga4f677656a04639fb33a080f0fa7a1011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f677656a04639fb33a080f0fa7a1011">&#9670;&nbsp;</a></span>twi_test_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t twi_test_address </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>adr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test presence of one I2C device on the bus. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adr</td><td>Slave address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK/NACK received value </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>- ACK has been received </td></tr>
    <tr><td class="paramname">1</td><td>- NACK has been received </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  121</span>{</div>
<div class="line"><span class="lineno">  122</span>    uint8_t ack;  <span class="comment">// ACK response from Slave</span></div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_function" href="group__fryza__twi.html#gaf37269da7f6b1b22438b78d2f965f274">twi_start</a>();</div>
<div class="line"><span class="lineno">  125</span>    ack = <a class="code hl_function" href="group__fryza__twi.html#ga129b8a79f75189c3801cb7082e6b8340">twi_write</a>((adr&lt;&lt;1) | <a class="code hl_define" href="group__fryza__twi.html#ga3b68e8e777b71520f9dbfac733774d5f">TWI_WRITE</a>);</div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_function" href="group__fryza__twi.html#gacf52d6c93df110dee6d402b389e5042e">twi_stop</a>();</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">return</span> ack;</div>
<div class="line"><span class="lineno">  129</span>}</div>
<div class="ttc" id="agroup__fryza__twi_html_ga129b8a79f75189c3801cb7082e6b8340"><div class="ttname"><a href="group__fryza__twi.html#ga129b8a79f75189c3801cb7082e6b8340">twi_write</a></div><div class="ttdeci">uint8_t twi_write(uint8_t data)</div><div class="ttdoc">Send one byte to I2C/TWI Slave device.</div><div class="ttdef"><b>Definition:</b> twi.c:59</div></div>
<div class="ttc" id="agroup__fryza__twi_html_ga3b68e8e777b71520f9dbfac733774d5f"><div class="ttname"><a href="group__fryza__twi.html#ga3b68e8e777b71520f9dbfac733774d5f">TWI_WRITE</a></div><div class="ttdeci">#define TWI_WRITE</div><div class="ttdoc">Mode for writing to I2C/TWI device.</div><div class="ttdef"><b>Definition:</b> twi.h:61</div></div>
<div class="ttc" id="agroup__fryza__twi_html_gacf52d6c93df110dee6d402b389e5042e"><div class="ttname"><a href="group__fryza__twi.html#gacf52d6c93df110dee6d402b389e5042e">twi_stop</a></div><div class="ttdeci">void twi_stop(void)</div><div class="ttdoc">Generates Stop condition on I2C/TWI bus.</div><div class="ttdef"><b>Definition:</b> twi.c:107</div></div>
<div class="ttc" id="agroup__fryza__twi_html_gaf37269da7f6b1b22438b78d2f965f274"><div class="ttname"><a href="group__fryza__twi.html#gaf37269da7f6b1b22438b78d2f965f274">twi_start</a></div><div class="ttdeci">void twi_start(void)</div><div class="ttdoc">Start communication on I2C/TWI bus.</div><div class="ttdef"><b>Definition:</b> twi.c:45</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fryza__twi_ga4f677656a04639fb33a080f0fa7a1011_cgraph.png" border="0" usemap="#agroup__fryza__twi_ga4f677656a04639fb33a080f0fa7a1011_cgraph" alt=""/></div>
<map name="agroup__fryza__twi_ga4f677656a04639fb33a080f0fa7a1011_cgraph" id="agroup__fryza__twi_ga4f677656a04639fb33a080f0fa7a1011_cgraph">
<area shape="rect" title="Test presence of one I2C device on the bus." alt="" coords="5,56,137,83"/>
<area shape="rect" href="group__fryza__twi.html#gaf37269da7f6b1b22438b78d2f965f274" title="Start communication on I2C/TWI bus." alt="" coords="187,5,266,32"/>
<area shape="rect" href="group__fryza__twi.html#gacf52d6c93df110dee6d402b389e5042e" title="Generates Stop condition on I2C/TWI bus." alt="" coords="188,56,265,83"/>
<area shape="rect" href="group__fryza__twi.html#ga129b8a79f75189c3801cb7082e6b8340" title="Send one byte to I2C/TWI Slave device." alt="" coords="185,107,268,133"/>
</map>
</div>

</div>
</div>
<a id="ga129b8a79f75189c3801cb7082e6b8340" name="ga129b8a79f75189c3801cb7082e6b8340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga129b8a79f75189c3801cb7082e6b8340">&#9670;&nbsp;</a></span>twi_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t twi_write </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send one byte to I2C/TWI Slave device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Byte to be transmitted </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK/NACK received value </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>- ACK has been received </td></tr>
    <tr><td class="paramname">1</td><td>- NACK has been received </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Function returns 0 if 0x18, 0x28, or 0x40 status code is detected<br  />
 0x18: SLA+W has been transmitted and ACK has been received<br  />
 0x28: Data byte has been transmitted and ACK has been received<br  />
 0x40: SLA+R has been transmitted and ACK has been received<br  />
</dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   60</span>{</div>
<div class="line"><span class="lineno">   61</span>    uint8_t twi_status;</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">/* Send SLA+R, SLA+W, or data byte on I2C/TWI bus */</span></div>
<div class="line"><span class="lineno">   64</span>    TWDR = <a class="code hl_variable" href="uart_8c.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>;</div>
<div class="line"><span class="lineno">   65</span>    TWCR = (1&lt;&lt;TWINT) | (1&lt;&lt;TWEN);</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordflow">for</span>(uint32_t i = 0; i &lt; <a class="code hl_define" href="twi_8c.html#aae1d7716ad5fb6be8b904e8a0def77c5">TWI_TIMEOUT</a> &amp;&amp; ((TWCR &amp; (1&lt;&lt;TWINT)) == 0); i++) <span class="keyword">asm</span>(<span class="stringliteral">&quot;NOP&quot;</span>);</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="comment">/* Check value of TWI status register */</span></div>
<div class="line"><span class="lineno">   69</span>    twi_status = TWSR &amp; 0xf8;</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="comment">/* Status Code:</span></div>
<div class="line"><span class="lineno">   72</span><span class="comment">          * 0x18: SLA+W has been transmitted and ACK received</span></div>
<div class="line"><span class="lineno">   73</span><span class="comment">          * 0x28: Data byte has been transmitted and ACK has been received</span></div>
<div class="line"><span class="lineno">   74</span><span class="comment">          * 0x40: SLA+R has been transmitted and ACK received</span></div>
<div class="line"><span class="lineno">   75</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">if</span> (twi_status == 0x18 || twi_status == 0x28 || twi_status == 0x40)</div>
<div class="line"><span class="lineno">   77</span>        <span class="keywordflow">return</span> 0;   <span class="comment">/* ACK received */</span></div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">return</span> 1;   <span class="comment">/* NACK received */</span></div>
<div class="line"><span class="lineno">   80</span>}</div>
<div class="ttc" id="auart_8c_html_a511ae0b1c13f95e5f08f1a0dd3da3d93"><div class="ttname"><a href="uart_8c.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a></div><div class="ttdeci">unsigned char data</div><div class="ttdef"><b>Definition:</b> uart.c:369</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="oled_8c.html#a91b0721118752b7208388903b69332e4">oled_command()</a>, <a class="el" href="oled_8c.html#a93bdfec1e1e604f1666485179d769f01">oled_data()</a>, <a class="el" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693">sensors_update_dataset()</a>, and <a class="el" href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011">twi_test_address()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__fryza__twi_ga129b8a79f75189c3801cb7082e6b8340_icgraph.png" border="0" usemap="#agroup__fryza__twi_ga129b8a79f75189c3801cb7082e6b8340_icgraph" alt=""/></div>
<map name="agroup__fryza__twi_ga129b8a79f75189c3801cb7082e6b8340_icgraph" id="agroup__fryza__twi_ga129b8a79f75189c3801cb7082e6b8340_icgraph">
<area shape="rect" title="Send one byte to I2C/TWI Slave device." alt="" coords="1256,352,1339,379"/>
<area shape="rect" href="oled_8c.html#a91b0721118752b7208388903b69332e4" title=" " alt="" coords="1057,327,1179,353"/>
<area shape="rect" href="oled_8c.html#a93bdfec1e1e604f1666485179d769f01" title=" " alt="" coords="700,131,787,157"/>
<area shape="rect" href="sensors_8c.html#a991004aa5afbe5511d9fe87599132693" title=" " alt="" coords="1028,377,1208,404"/>
<area shape="rect" href="group__fryza__twi.html#ga4f677656a04639fb33a080f0fa7a1011" title="Test presence of one I2C device on the bus." alt="" coords="1052,428,1184,455"/>
<area shape="rect" href="oled_8c.html#afef0e0a3d794e2cd2132e24b65fc55c0" title=" " alt="" coords="873,403,950,429"/>
<area shape="rect" href="oled_8c.html#a869429d91a0e3b943fa70344cea07f52" title=" " alt="" coords="843,251,979,277"/>
<area shape="rect" href="oled_8c.html#adf4cfb5ed444b0ab8cd162456c017934" title=" " alt="" coords="185,435,263,461"/>
<area shape="rect" href="oled_8c.html#acbecdceb919c4ca42478f8f8631a588b" title=" " alt="" coords="528,29,613,56"/>
<area shape="rect" href="oled_8c.html#a55064af8d04c97be4ec4751b1e7566eb" title=" " alt="" coords="864,536,959,563"/>
<area shape="rect" href="oled_8c.html#a551373c9f50c6edcbf0aff140c98535a" title=" " alt="" coords="843,301,980,328"/>
<area shape="rect" href="oled_8c.html#a0e010462121972ef0669b30f68d68b7b" title=" " alt="" coords="865,352,957,379"/>
<area shape="rect" href="oled_8c.html#ad9a1e40ca811bb4c2f095b31e3c3def1" title=" " alt="" coords="497,181,644,208"/>
<area shape="rect" href="oled_8c.html#a89aa3a9a7daa84a50f00399d32d9dfa2" title=" " alt="" coords="692,283,795,309"/>
<area shape="rect" href="display_8c.html#a8d41c12af4f6e6faad84e1f21f99b3e1" title=" " alt="" coords="5,333,103,360"/>
<area shape="rect" href="display_8c.html#af6002a9b15fd411e61bc74a7ace0d457" title=" " alt="" coords="151,283,297,309"/>
<area shape="rect" href="oled_8c.html#a87e32cd0efcfb14bfa3c71e386498df6" title=" " alt="" coords="351,384,443,411"/>
<area shape="rect" href="oled_8c.html#aebb4380fed7380f42c7c465430de9012" title=" " alt="" coords="345,232,449,259"/>
<area shape="rect" href="oled_8c.html#ac3d3bd3760c4da609cc310cba9887a55" title=" " alt="" coords="523,435,618,461"/>
<area shape="rect" href="oled_8c.html#a8daec8fb691af3b411501856f9291683" title=" " alt="" coords="355,181,440,208"/>
<area shape="rect" href="oled_8c.html#a6c489aec7c018385dc95b01400ef1f14" title=" " alt="" coords="347,29,447,56"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
